# Legacy Media Restorer & Translator

A Linux toolkit to rescue, convert, and translate old video formats (WMA, ASF, ASX) into modern standards, preparing them for AI Remastering.

## üöÄ What this does
1. **Fixes Formats:** Renames deceptively named `.asx` files to `.asf`.
2. **Converts:** Uses `ffmpeg` to convert legacy containers to high-quality MP4 (H.264) and cleans interlacing artifacts.
3. **Transcribes & Translates:** Uses OpenAI Whisper locally to extract audio, recognize speech (Spanish/Other), and generate **English** subtitles (`.srt`) automatically.

## üõ† Prerequisites
You need a Linux system (Debian/Ubuntu/Fedora).

## üì¶ Installation

1. Clone this repository.
2. Make the scripts executable:
   ```bash
   chmod +x setup_env.sh process_batch.sh

```
./setup_env.sh

```


‚ñ∂Ô∏è Usage

Put all your old .wma, .asf, or .asx files into a folder (e.g., input_files/).

Run the script pointing to that folder:
Bash

./process_batch.sh ./input_files

Output: You will find a processed/ folder containing:

    video_clean.mp4: The modernized video file.

    audio_track.mp3: Isolated audio.

    subtitles.srt: English subtitles synchronized to the video.

üé® The AI Remastering Guide (Post-Processing)

These scripts prepare your files. To achieve "Pro Quality," follow these steps with the output files:
Phase 1: Video Upscaling

    Problem: The video is likely 320x240 or 480p resolution.

    Tool: Topaz Video AI (Recommended) or Real-ESRGAN (Free/Linux).

    Action: Upscale the video_clean.mp4 to 1080p or 4K.

Phase 2: Audio Restoration

    Problem: Old microphones have hiss and background noise.

    Tool: Adobe Podcast Enhance (Free Web Tool).

    Action: Upload the audio_track.mp3 generated by this script. Download the enhanced version.

Phase 3: Translation Polish (Optional)

    Tool: Google Gemini Advanced.

    Action: If the automated English subtitles have nuances that feel robotic, upload the .srt file to Gemini and ask: "Review these subtitles for natural flow and idiomatic accuracy, keeping the timestamps exactly the same."

Phase 4: Final Assembly

Use a video editor (or ffmpeg) to combine the Upscaled Video, Enhanced Audio, and Subtitles into one final master file.


---
```bash
```

### 2. The Setup Script (`setup_env.sh`)
This ensures the user has the necessary tools.

```bash
#!/bin/bash

# setup_env.sh
# Installs dependencies for the media restoration pipeline

echo "--- Checking System Dependencies ---"

# Check for FFmpeg
if ! command -v ffmpeg &> /dev/null; then
    echo "FFmpeg not found. Installing..."
    sudo apt-get update && sudo apt-get install -y ffmpeg python3-pip python3-venv git
else
    echo "‚úÖ FFmpeg is installed."
fi

# Check for Python/Pip
if ! command -v pip3 &> /dev/null; then
    echo "Pip not found. Installing..."
    sudo apt-get install -y python3-pip
fi

echo "--- Setting up Python Environment for Whisper ---"

# Create a virtual environment to avoid system conflicts
if [ ! -d "venv" ]; then
    python3 -m venv venv
fi

# Activate environment and install OpenAI Whisper
source venv/bin/activate
pip install -U openai-whisper
pip install setuptools-rust

echo "‚úÖ Installation Complete."
echo "You can now run ./process_batch.sh"

### 2. The Setup Script (`setup_env.sh`)
This ensures the user has the necessary tools.

```bash
#!/bin/bash

# setup_env.sh
# Installs dependencies for the media restoration pipeline

echo "--- Checking System Dependencies ---"

# Check for FFmpeg
if ! command -v ffmpeg &> /dev/null; then
    echo "FFmpeg not found. Installing..."
    sudo apt-get update && sudo apt-get install -y ffmpeg python3-pip python3-venv git
else
    echo "‚úÖ FFmpeg is installed."
fi

# Check for Python/Pip
if ! command -v pip3 &> /dev/null; then
    echo "Pip not found. Installing..."
    sudo apt-get install -y python3-pip
fi

echo "--- Setting up Python Environment for Whisper ---"

# Create a virtual environment to avoid system conflicts
if [ ! -d "venv" ]; then
    python3 -m venv venv
fi

# Activate environment and install OpenAI Whisper
source venv/bin/activate
pip install -U openai-whisper
pip install setuptools-rust

echo "‚úÖ Installation Complete."
echo "You can now run ./process_batch.sh"--
---

### 2. The Setup Script (`setup_env.sh`)
This ensures the user has the necessary tools.

```bash
#!/bin/bash

# setup_env.sh
# Installs dependencies for the media restoration pipeline

echo "--- Checking System Dependencies ---"

# Check for FFmpeg
if ! command -v ffmpeg &> /dev/null; then
    echo "FFmpeg not found. Installing..."
    sudo apt-get update && sudo apt-get install -y ffmpeg python3-pip python3-venv git
else
    echo "‚úÖ FFmpeg is installed."
fi

# Check for Python/Pip
if ! command -v pip3 &> /dev/null; then
    echo "Pip not found. Installing..."
    sudo apt-get install -y python3-pip
fi

echo "--- Setting up Python Environment for Whisper ---"

# Create a virtual environment to avoid system conflicts
if [ ! -d "venv" ]; then
    python3 -m venv venv
fi

# Activate environment and install OpenAI Whisper
source venv/bin/activate
pip install -U openai-whisper
pip install setuptools-rust

echo "‚úÖ Installation Complete."
echo "You can now run ./process_batch.sh"
```


### 2. The Setup Script (`setup_env.sh`)
This ensures the user has the necessary tools.

```bash
#!/bin/bash

# setup_env.sh
# Installs dependencies for the media restoration pipeline

echo "--- Checking System Dependencies ---"

# Check for FFmpeg
if ! command -v ffmpeg &> /dev/null; then
    echo "FFmpeg not found. Installing..."
    sudo apt-get update && sudo apt-get install -y ffmpeg python3-pip python3-venv git
else
    echo "‚úÖ FFmpeg is installed."
fi

# Check for Python/Pip
if ! command -v pip3 &> /dev/null; then
    echo "Pip not found. Installing..."
    sudo apt-get install -y python3-pip
fi

echo "--- Setting up Python Environment for Whisper ---"

# Create a virtual environment to avoid system conflicts
if [ ! -d "venv" ]; then
    python3 -m venv venv
fi

# Activate environment and install OpenAI Whisper
source venv/bin/activate
pip install -U openai-whisper
pip install setuptools-rust

echo "‚úÖ Installation Complete."
echo "You can now run ./process_batch.sh"

3. The Master Processor (process_batch.sh)

This script handles the heavy lifting: Logic, Conversion, and Transcription.
Bash

#!/bin/bash

# process_batch.sh
# Usage: ./process_batch.sh /path/to/files

INPUT_DIR="$1"
OUTPUT_DIR="$INPUT_DIR/processed"

# Check if input directory is provided
if [ -z "$INPUT_DIR" ]; then
    echo "Error: Please provide a directory path."
    echo "Usage: ./process_batch.sh ./my_old_videos"
    exit 1
fi

# Activate Python environment for Whisper
if [ -f "venv/bin/activate" ]; then
    source venv/bin/activate
else
    echo "Error: Virtual environment not found. Run ./setup_env.sh first."
    exit 1
fi

mkdir -p "$OUTPUT_DIR"

echo "--- Starting Batch Process on $INPUT_DIR ---"

# Loop through likely extensions
for file in "$INPUT_DIR"/*.{asx,asf,wma,wmv}; do
    [ -e "$file" ] || continue # Skip if no files found

    filename=$(basename -- "$file")
    basename="${filename%.*}"
    
    echo "=========================================="
    echo "Processing: $filename"
    echo "=========================================="

    # 1. FIX EXTENSION (Handle ASX usually being ASF)
    # We don't rename the original, we just treat it as ASF input
    
    # 2. CONVERT VIDEO
    # -vf yadif: De-interlace (crucial for old TV recordings)
    # -crf 18: High quality visual preservation
    # -c:a aac: Standard audio
    echo "Step 1: Converting video to MP4..."
    ffmpeg -y -i "$file" \
        -c:v libx264 -preset slow -crf 18 -vf yadif \
        -c:a aac -b:a 192k \
        "$OUTPUT_DIR/${basename}_clean.mp4" -hide_banner -loglevel error

    if [ $? -eq 0 ]; then
        echo "‚úÖ Video conversion successful."
    else
        echo "‚ùå Video conversion failed. Check input file."
        continue
    fi

    # 3. EXTRACT AUDIO (For transcription)
    echo "Step 2: Extracting audio for transcription..."
    ffmpeg -y -i "$OUTPUT_DIR/${basename}_clean.mp4" \
        -vn -acodec libmp3lame -q:a 2 \
        "$OUTPUT_DIR/${basename}.mp3" -hide_banner -loglevel error

    # 4. TRANSCRIBE & TRANSLATE (Whisper)
    # --task translate: Translates ANY language input directly to English text
    # --model medium: Good balance. Use 'large' if you have a GPU.
    echo "Step 3: Transcribing and Translating to English..."
    whisper "$OUTPUT_DIR/${basename}.mp3" --model medium --task translate --output_format srt --output_dir "$OUTPUT_DIR"

    echo "‚úÖ Finished processing $basename"
done

echo "--- All tasks complete! Check the '$OUTPUT_DIR' folder. ---"

Next Steps for You

    Initialize Git: In your folder, run git init.

    Add these files: Create the three files above.

    Create .gitignore: Make sure you add venv/ and *.mp4 to a .gitignore file so you don't upload massive video files or the python environment to GitHub.

    Publish: git add ., git commit -m "Initial commit", and push to your repo.

You now have a clean, shareable solution that leverages your Linux environment to prep files for the AI era!
